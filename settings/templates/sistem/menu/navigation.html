{% extends "admin_base.html" %}

{% block page_title %}Application Menu{% endblock %}
{% block page_heading %}Application Menu{% endblock %}

{% block breadcrumbs %}
<li class="breadcrumb-item"><a href="/settings/overview">Overview</a></li>
<li class="breadcrumb-item"><a href="/settings/sistem/menu">Menu</a></li>
<li class="breadcrumb-item active">Edit</li>
{% endblock %}

{% block content %}
<div class="card">
  <div class="card-header">
    <h3 class="card-title">
      {% if portal.portal_nm %}{{ portal.portal_nm }}{% endif %}
    </h3>
    <div class="card-tools">
      <a href="/settings/sistem/menu" class="btn btn-sm btn-secondary">
        <i class="bi bi-arrow-left"></i> Back
      </a>
      <a href="/settings/sistem/menu/{{ portal.portal_id }}/add" class="btn btn-sm btn-primary">
        <i class="bi bi-plus-circle"></i> Add Menu
      </a>
    </div>
  </div>
  <div class="card-body">
    {% if messages %}
      {% for message in messages %}
        <div class="alert alert-{% if message.tags == 'error' %}danger{% else %}{{ message.tags }}{% endif %} alert-dismissible fade show" role="alert">
          <button type="button" class="close" data-dismiss="alert">Ã—</button>
          {{ message }}
        </div>
      {% endfor %}
    {% endif %}
    <div class="table-responsive">
      <table class="table table-striped table-bordered">
        <thead class="thead-light">
          <tr>
            <th style="width:80px">Icon</th>
            <th>Menu Name</th>
            <th>URL</th>
            <th style="width:80px">Active</th>
            <th style="width:90px">Display</th>
            <th style="width:170px">Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for m in menus %}
          <tr>
            <td>
              {% if m.nav_icon %}
                <i class="{{ m.nav_icon }}"></i>
              {% else %}
                -
              {% endif %}
            </td>
            <td>
              {{ m.indent_prefix }}{{ m.nav_name }}
            </td>
            <td>
              <code>{{ m.nav_url }}</code>
            </td>
            <td class="text-center">
              {% if m.active_st == '1' %}
                <i class="bi bi-check-circle text-success"></i>
              {% else %}
                <i class="bi bi-x-circle text-danger"></i>
              {% endif %}
            </td>
            <td class="text-center">
              {% if m.display_st == '1' %}
                <i class="bi bi-check-circle text-success"></i>
              {% else %}
                <i class="bi bi-x-circle text-danger"></i>
              {% endif %}
            </td>
            <td>
              <a class="btn btn-sm btn-warning" href="/settings/sistem/menu/{{ portal.portal_id }}/nav/{{ m.nav_id }}/edit">
                <i class="bi bi-pencil"></i>
              </a>
              <form method="post" action="/settings/sistem/menu/{{ portal.portal_id }}/nav/{{ m.nav_id }}/delete" style="display:inline-block" onsubmit="return confirm('Delete menu {{ m.nav_name }}?')">
                {% csrf_token %}
                <button type="submit" class="btn btn-sm btn-danger">
                  <i class="bi bi-trash"></i>
                </button>
              </form>
            </td>
          </tr>
          {% empty %}
          <tr><td colspan="6" class="text-center text-muted">No menu items</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}